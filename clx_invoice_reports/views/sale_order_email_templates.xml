<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <!--Email template -->
    <record id="sale_order_clx_email_template" model="mail.template">
        <field name="name">Sales Order: CLX email template</field>
        <field name="email_from">${(object.user_id.email_formatted or user.email_formatted) | safe}</field>
        <field name="subject">${object.partner_id.name}  - Conversion Logix Contract</field>
        <field name="reply_to">${object.partner_id.account_user_id.partner_id.email}</field>
        <field name="model_id" eval="336"/>
        <!-- 336 - model id for sales.order -->
        <field name="auto_delete" eval="True"/>
        <field name="lang">${object.partner_id.lang}</field>
        <field name="report_name">${(object.name or '').replace('/','_')}</field>
        <field name="report_template" eval="388"/>
        <field name="body_html" type="html">
            <table border="0" cellpadding="0" cellspacing="0" width="100%" style="background-color: white; padding: 0; border-collapse:separate;">
                <tr>
                    <td valign="middle">
                        <span style="font-size: 10px;">Your Quotation</span>
                        <br/>
                        <span style="font-size: 20px; font-weight: bold;">
                        ${object.name}
                        </span>
                    </td>
                    <td valign="middle" align="right">
                        <img src="/logo.png?company=1" style="padding: 0px; margin: 0px; height: 48px;" alt="company.name"/>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align:center;">
                        <hr width="100%" style="background-color:rgb(204,204,204);border:medium none;clear:both;display:block;font-size:0px;min-height:1px;line-height:0; margin:4px 0px 32px 0px;"/>
                    </td>
                </tr>
            </table>
            <div style="font-size:13px;font-family:&quot;Lucida Grande&quot;, Helvetica, Verdana, Arial, sans-serif;margin:0px;padding: 0px;">
                <p style="margin:0px;font-size:13px;font-family:&quot;Lucida Grande&quot;, Helvetica, Verdana, Arial, sans-serif;padding: 0px; font-size: 13px;">
                        % set doc_name = 'quotation' if object.state in ('draft', 'sent') else 'order'
                        % set secure_url = ctx.get('secure_url') 
                        Hello,
                    <br/>
                    <br/>
                        Your Conversion Logix Digital AdTech services contract is ready for signature.<br/><br/>
                    Please press “Accept &amp; Sign Quotation” below to review and e-sign the agreement for <strong style="font-weight:bolder;">${object.partner_id.name}</strong> in the amount of <strong style="font-weight:bolder;">${format_amount(object.amount_total, object.pricelist_id.currency_id)}</strong>. If changes are made, your Conversion Logix Account Manager is copied on this email and will be notified.<br/><br/>
                    Once signed, a copy of the executed contract will be delivered to your email and your account manager will reach out with implementation forms needed to begin the launch of this campaign.<br/>
                    <br/>
                        Thank you for your partnership! 
                    <br/>
                    <br/>
                        <strong style="font-weight:bolder;">${object.partner_id.account_user_id.name}</strong> &amp; The Conversion Logix Team 
                    <br/>
                </p>
            </div>
            <div t-if="is_online and not record._context.get('proforma')" style="margin: 32px 0px 32px 0px; text-align: center;">
                <a href="${secure_url}" style="background-color: #875A7B; padding: 8px 16px 8px 16px; text-decoration: none; color: #fff; border-radius: 5px; font-size:13px;">
                        Accept &amp; Sign Quotation
                </a>
            </div>
        </field>
        <field name="user_signature" eval="False"/>
    </record>

    <!-- Confirmation email template for signed contract -->
    <record id="contract_confirmation_clx_email_template" model="mail.template">
        <field name="name">Contract: Signing confirmation</field>
        <field name="email_from">${(object.user_id.email_formatted or user.email_formatted) | safe}</field>
        <field name="subject">${object.partner_id.name} - Conversion Logix Contract</field>
        <field name="model_id" eval="336"/>
        <!-- 336 - model id for sales.order -->
        <field name="auto_delete" eval="True"/>
        <field name="lang">${object.partner_id.lang}</field>
        <field name="report_name">${(object.name or '').replace('/','_')}</field>
        <field name="report_template" eval="388"/>
        <field name="body_html" type="html">
            <div style="font-size:13px;font-family:&quot;Lucida Grande&quot;, Helvetica, Verdana, Arial, sans-serif;margin:0px;padding: 0px;">
                <p style="margin:0px;font-size:13px;font-family:&quot;Lucida Grande&quot;, Helvetica, Verdana, Arial, sans-serif;padding: 0px; font-size: 13px;">
                        % set doc_name = 'quotation' if object.state in ('draft', 'sent') else 'order'
                        % set secure_url = ctx.get('secure_url') 
                        Hello,
                    <br/>
                    <br/>
                    Your quotation for <strong style="font-weight:bolder;">${object.partner_id.name}</strong> totaling <strong style="font-weight:bolder;">${format_amount(object.amount_total, object.pricelist_id.currency_id)}</strong> has been confirmed.
                    <br/><br/>
                    Thank you for your business!
                    <br/><br/>
                    Do not hesitate to contact us if you have any questions.  
                    <br/><br/>
                        The Conversion Logix Team 
                    <br/>

                </p>
            </div>

        </field>
        <field name="user_signature" eval="False"/>
    </record>
    <!-- Change the mail form template to eleminate the followers message  -->
    <record model="ir.ui.view" id="email_compose_form_sale_order_form">
        <field name="name">mail.compose.message.form.sale_order_form</field>
        <field name="model">mail.compose.message</field>
        <field name="inherit_id" ref="mail.email_compose_message_wizard_form"/>
        <field name="arch" type="xml">
            <xpath expr="//span[@name='document_followers_text']" position="replace">
            </xpath>
            <xpath expr="//field[@name='partner_ids']" position="replace">
                <field name="allowed_partner_ids" invisible="1" />
                <field name="partner_ids" widget="many2many_tags_email" placeholder="Add contacts to notify..." domain="[('id', 'in', allowed_partner_ids)]" options="{'no_create': True}"/>
                <field name="reply_to" placeholder="Send copy ...   "  invisible="1"/>
                <field name="email_to" placeholder="Add additional e-mails to notify..." />
            </xpath>
            <xpath expr="//footer/button[@name='action_send_mail' and contains(@class,'o_mail_send')]" position="replace">
                <button string="Send" attrs="{'invisible': [('is_log', '=', True)]}" name="clx_action_send_mail" type="object" class="btn-primary o_mail_send"/>
            </xpath>

        </field>
    </record>
</odoo>